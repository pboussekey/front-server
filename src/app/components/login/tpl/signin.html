<div id="login" class="signin">
    <notifier></notifier>
    <form id="loginform" ng-submit="ctrl.signInWithPassword()" ng-if="ctrl.user" autocomplete="off">
        <div class="global_loader discreet" ng-class="{ loading : ctrl.processing }"></div>
        <div class="logo"></div>

        <h1>{{ ::ctrl.title || "Welcome " + (ctrl.is_active ? "back" : "") + " to TWIC" }}</h1>
        <h2>{{ ::ctrl.subtitle || (ctrl.is_active ? "Reset your password" : "Now your account is activated, let's get you set up!") }}</h2>

        <div class="input_area" ng-class="{invalid:ctrl.firstname_error}" ng-if-start="!ctrl.is_active">
            <span class="err" role="alert" translate>{{ ctrl.errorLabels[ctrl.firstname_error] }}</span>
            <input id="i_firstname" type="text" name="i_firstname" placeholder="Firstname*"
                required ng-model="ctrl.firstname">
        </div>
        <div class="input_area" ng-class="{invalid:ctrl.lastname_error}" >
            <span class="err" role="alert" translate>{{ ctrl.errorLabels[ctrl.lastname_error] }}</span>
            <input id="i_lastname" type="text" name="password" placeholder="Lastname*"
                required ng-model="ctrl.lastname">
        </div>
        <div class="input_area" ng-class="{invalid:ctrl.graduation_error}">
            <span class="err" role="alert" translate>{{ ctrl.errorLabels[ctrl.lastname_error] }}</span>
            <input id="i_graduation_year" type="text" name="graduation_year" placeholder="Class year" ng-model="ctrl.graduation_year">
        </div>
        <div class="autocomplete input_area" ng-if-end
            ui-autocomplete="ctrl.searchPrograms"
            autocomplete-id="i_program"
            placeholder="Program"
            autocomplete-search="ctrl.search_program"
            autocomplete-items="ctrl.programs"
            autocomplete-pagination="10"
            min-length="0">
                <button
                    ng-repeat="program in ctrl.programs"
                    title="{{program.name}}"
                    ng-click="ctrl.search_program.search = program.name"
                    ng-if="program.name !== ctrl.search_program.search"
                    autocomplete-result="{{program.name}}"
                    result-search="ctrl.search_program.search"
                    type="button" >
                </button>
                <div autocomplete-result class="loading" ng-if="ctrl.loadingPrograms"></div>
        </div>
        <div class="input_area" ng-class="{invalid:ctrl.password_error}">
            <span class="err" role="alert" translate>{{ ctrl.errorLabels[ctrl.password_error] }}</span>
            <input id="i_pwd" type="password" name="password" autocomplete="new-password"

                   placeholder="{{ ctrl.is_active ? 'New password*' : 'Password*' }}"
                   ng-change="ctrl.onPwdChange()"
                required ng-model="ctrl.password">
                <div tooltip class="pwd-tooltip right bottom">
                    <div class="pwd-strength" tooltip-toggle>
                        <div class="pwd-bar" ng-class="{  bad : ctrl.pwd_strength === 1, medium : ctrl.pwd_strength === 2, good : ctrl.pwd_strength === 3, excelent : ctrl.pwd_strength === 4 }"></div>
                    </div>
                    <div tooltip-content>
                        Minimum 8 characters, Include capital letters, special characters and numbers.
                    </div>
                </div>
        </div>
        <div class="input_area" ng-class="{invalid:ctrl.password_error}">
            <input id="i_pwd2" type="password" name="cfm_password" autocomplete="new-password"
                placeholder="Confirm your password*"
                ng-model="ctrl.confirm_password" required>
        </div>

        <div class="ctas full">
            <button class="cta green" type="submit">{{ ctrl.isPasswordForgotten&&'Confirm and log in'||'Sign up' }}</button>
        </div>

        <div class="terms" ng-if="!ctrl.isPasswordForgotten">
            <span>By clicking Sign up, I agree to TWICAPP INC's</span>
            <button ng-click="ctrl.openTC($event)">Terms of Service</button>
            <span>and</span>
            <button ng-click="ctrl.openPrivacies($event)">Privacy Policy</button>
        </div>

        <div ng-if="ctrl.powered" id="powered">
            <span>Powered by</span>
            <img src="assets/img/twic.png">
        </div>
        <a ui-sref="login" class="i-return i2 back" title="Back"> </a>
    </form>

    <form id="loginform" ng-submit="ctrl.signInWithEmail()" ng-if="!ctrl.user">
        <div class="logo"></div>
        <div class="global_loader discreet" ng-class="{ loading : ctrl.processing }"></div>

        <h1>{{ ::ctrl.title || "Welcome to TWIC" }}</h1>
        <h2 ng-bind-html="ctrl.subtitle || (!ctrl.organizations || !ctrl.organizations.length) ? 'Sign up with an academic email' : 'Great! Now we just need to check your institution'"></h2>
        <div class="input_area" ng-class="{invalid:ctrl.email_error}">
            <label for="i_email">
                <span>Email*</span>
            </label>
            <span class="err" role="alert" translate>{{ ctrl.errorLabels[ctrl.email_error] }}</span>
            <input id="i_email" type="email" name="i_email" placeholder=""
                ng-if="!ctrl.organizations || !ctrl.organizations.length"
                required ng-model="ctrl.email">
            <div ng-if="ctrl.organizations && ctrl.organizations.length">{{ ctrl.email }}</div>
        </div>
        <div ng-if="ctrl.organizations && ctrl.organizations.length"><b>Institution*</b></div>
         <div class="center classic right organizations_dd" dropdown ng-if="ctrl.organizations && ctrl.organizations.length">
            <button dropdown-toggle class="cta white dropdown" type="button">
              <div class="org_logo " ng-if="ctrl.organization"
                  image-size="[80,'m',80]"
                  image-onload="{{ctrl.organization.logo}}"
                  data-letter="{{ ctrl.organization.logo ? (ctrl.organization|pageletter) : null }}">
              </div>
              <div> {{ !ctrl.organization ? 'Select your institution' : ctrl.organization.title }}</div>
                <span class="i12 i-dropdown" ng-class="{ 'single' : ctrl.organizations.length < 2 }"></span>
            </button>
            <div dropdown-content class="hdr_ddcontent ">
                <button type="button" ng-click="ctrl.organization = organization"
                    ng-if="ctrl.organization.id !== organization.id"
                    ng-repeat="organization in ctrl.organizations">
                        <div class="org_logo "
                            image-size="[80,'m',80]"
                            image-onload="{{organization.logo}}"
                            data-letter="{{ organization.logo ? (organization|pageletter) : null }}">
                        </div>
                        <div>{{ organization.title }}</div>
                </button>
            </div>

        </div>
        <div ng-if="ctrl.organizations && ctrl.organizations.length" id="contact-us">Not yours? <span ng-click="ctrl.help()" class="u">Contact us</span></div>
        <div class="ctas full">
            <button class="cta green" type="submit">{{ !ctrl.organizations ? 'Next' :  'Sign up' }}</button>
        </div>
        <div class="terms" ng-if="ctrl.organization">
            <span>By clicking Sign up, I agree to TWICAPP INC's</span>
            <button ng-click="ctrl.openTC($event)">Terms of Service</button>
            <span>and</span>
            <button ng-click="ctrl.openPrivacies($event)">Privacy Policy</button>
        </div>

        <div ng-if="ctrl.powered" id="powered">
            <span>Powered by</span>
            <img src="assets/img/twic.png">
        </div>
        <a  ui-sref="login" class="i-return i2 back" title="Back"> </a>

        <div ng-if="!ctrl.organizations || !ctrl.organizations.length" id="contact-us">Need help? <span ng-click="ctrl.help()" class="u">Contact us</span></div>
    </form>

    <footer>
        <div class="links">
            <a href="{{ ::CONFIG.enterprise.link }}">
                <span ng-bind-html="CONFIG.enterprise.title | trustHtml"></span> Â© {{ ctrl.year }}</a>
            <button ng-click="ctrl.openPrivacies($event)">Privacy</button>
            <button ng-click="ctrl.openTC($event)">Terms & Conditions</button>
            <button ng-click="ctrl.help()">Assistance</button>
        </div>


        <div class="socials">

            <a class="i16 i-linkedin" ng-href="{{ ::CONFIG.social.linkedin }}"
               title="Meet us on Linkedin">
                <span class="for_screen_reader">Meet us on Linkedin</span>
            </a>
            <a class="i16 i-facebook" ng-href="{{ ::CONFIG.social.facebook }}"
               title="Meet us on Facebook">
                <span class="for_screen_reader">Meet us on Facebook</span>
            </a>
            <a class="i16 i-twitter" ng-href="{{ ::CONFIG.social.twitter }}"
               title="Meet us on Twitter">
                <span class="for_screen_reader">Meet us on Twitter</span>
            </a>

        </div>
    </footer>
</div>
